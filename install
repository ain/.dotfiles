#!/bin/bash

echo "Installing dotfiles..."

# Working directory
PWD=`pwd`

echo "  installing Bash profile "
unlink ~/.bash_profile
ln -s $PWD/.bash_profile ~/.bash_profile

echo "  installing global Git ignore configuration "
unlink ~/.gitignore
ln -s $PWD/.gitignore ~/.gitignore

echo "  populating generic Git configuration "
git config --global core.excludesfile ~/.gitignore

echo "  installing terminal-notifier "
gem install terminal-notifier

echo "  installing Composer descriptors "
mkdir -p ~/.composer
unlink ~/.composer/composer.json
unlink ~/.composer/composer.lock
ln -s $PWD/.composer/composer.json ~/.composer/composer.json
ln -s $PWD/.composer/composer.lock ~/.composer/composer.lock

function remove_configuration {
  if [ -h "$1" ]
  then
    unlink "$1"
  elif [ -f "$1" ]
  then
    rm "$1"
  fi
}

function install_keyboard_bindings {
  echo "  installing keyboard bindings "
  local path="$HOME/Library/Application Support/Karabiner/private.xml"
  remove_configuration "$path"
  ln -s "$PWD/karabiner/private.xml" "$path"
}

install_keyboard_bindings

echo "Installation finished!"
